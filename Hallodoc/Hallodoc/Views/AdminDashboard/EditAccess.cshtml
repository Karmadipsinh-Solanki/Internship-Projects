@{
    ViewData["Title"] = "EditAccess";
}
@model EditAccessViewModel;
@section Styles {
    <link href="~/css/accountAccess.css" rel="stylesheet" type="text/css" />
}
<div id="body" style="background-color: rgb(245, 245, 245);height:100vh">
    <div class="shadow header-nav-container">
        <partial name="Toast" />
        <partial name="AdminDashboardHeader" model="@Model.adminNavbarViewModel" />
    </div>
    <div style="display: flex;flex-direction: row;">

        <div id="main-div" style="width: 100%;">
            <div id="main-sub-div" class="tabcontent">
                <div class="title-and-back">

                    <h4>Edit Access</h4>
                    <a onclick="goBack()" class="back-navigation-link-3">
                        <div class="back-navigation">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#00ccff" class="bi bi-chevron-left" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0" />
                            </svg>
                            <span>Back</span>
                        </div>
                    </a>
                </div>
                @*</div>*@
                <div id="main-sub-div-part">
                    <form asp-action="EditAccess" asp-controller="AdminDashboard" method="post">
                        <input asp-for="RoleId" type="text" class="hide" id="SelectedMenuItems" />
                        @*<input asp-for="AccountType" type="text" class="hide" id="account-type"/>*@
                        <h4>Details</h4>
                        <div class="form-sub-div" style="margin-top: 20px;">
                            <div class="form-floating login-fields login-fields-2">
                                <input type="text" placeholder="Role Name" class="form-control" asp-for="RoleName" />
                                <label for="first-name" class="labels">Role Name</label>
                            </div>
                            <div class="form-floating login-fields">
                                <label for="Password" class="labels" style="top:-17px;font-size:12px;">Account Type</label>
                                <select class="custom-select" asp-for="AccountType" id="select-account-type" style="width:100% !important;height:50px;">
                                    @*<option value="0" style="color:gray !important;"><span style="color:gray;">All</span></option>*@
                                    <option value="admin-div" style="color:gray !important;"><span style="color:gray;">Admin</span></option>
                                    <option value="provider-div" style="color:gray !important;"><span style="color:gray;">Provider</span></option>
                                </select>
                            </div>
                        </div>

                        <div class="menu-items hide" id="admin-div">

                            @foreach (var item in Model.Query)
                            {
                                @if (@item.AccountType == 2)
                                {
                                    <div class="menu-item">
                                        <input type="checkbox" data-menu-id="@item.MenuItemId" checked="@item.IsSelected" class="checkbox" value="@item.MenuItemId" />
                                        <label>@item.Name</label>
                                    </div>
                                }
                            }
                        </div>


                        <div class="menu-items hide" id="provider-div">
                            @foreach (var item in Model.Query)
                            {
                                @if (@item.AccountType == 1)
                                {
                                    <div class="menu-item">
                                        <input type="checkbox" data-menu-id="@item.MenuItemId" checked="@item.IsSelected" class="checkbox" value="@item.MenuItemId" />
                                        <label>@item.Name</label>
                                    </div>
                                }
                            }
                        </div>

                        <div class="buttons-parent-div">
                            <button type="submit" class="save-button"><span>Save</span></button>
                            <a class="cancel-button" onclick="cancelButton()"><span>Cancel</span></a>
                        </div>
                        <!-- <h5 style="margin-bottom: 30px;margin-top: 20px;" class="title">(Optional) Upload Photo or Document</h5> -->
                    </form>

                </div>
            </div>
        </div>
    </div>
    <script>
        function cancelButton() {
            location.reload();
        }
        var accountType = document.getElementById("select-account-type").value;
        document.getElementById(accountType).classList.remove("hide");
        var selectedMenuItems;
        $(document).ready(function () {
            selectedMenuItems = $('#SelectedMenuItems').val();
            var ticked = document.getElementsByClassName('checkbox');
            for (var i = 0; i < ticked.length; i++) {
                if (ticked[i].checked) {
                    selectedMenuItems += (selectedMenuItems ? ',' : '') + ticked[i].value;
                }
            }
            $('.checkbox').change(function () {
                var menuId = $(this).data('menuId');
                var isChecked = $(this).is(':checked');

                // Update selectedRegion string based on checkbox state
                if (isChecked) {
                    selectedMenuItems += (selectedMenuItems ? ',' : '') + menuId;
                } else {
                    selectedMenuItems = selectedMenuItems.replace(new RegExp(',' + menuId + '|^' + menuId + ','), '');
                }
                console.log(selectedMenuItems);
                $('#SelectedMenuItems').val(selectedMenuItems);
            });
        });
        document.getElementById('select-account-type').addEventListener('change', function () {
            selectedMenuItems = "";
            var selectedItems = document.getElementsByClassName("checkbox");
            for (var i = 0; i < selectedItems.length; i++) {
                selectedItems[i].checked = false;
            }
            $('#SelectedMenuItems').val(selectedMenuItems);
            var id = document.getElementById('select-account-type').value;
            var menuClasses = document.getElementsByClassName('menu-items');
            for (var i = 0; i < menuClasses.length; i++) {
                if (menuClasses[i].id == id) {
                    menuClasses[i].classList.remove('hide');
                } else {
                    menuClasses[i].classList.add('hide');
                }
            }
            //document.getElementById(id).classList.remove()
        });
        function goBack() {
            window.history.back();
        }

        let sidebarOpen = false;
        function hamburger() {
            if (!sidebarOpen) {
                console.log('hi');
                document.getElementById('sidebar').style.display = "flex";
                document.getElementById('main-div').style.opacity = "0.5";
                document.getElementById('main-div').style.backgroundColor = "rgba(0, 0, 0, 0.1)";
                document.getElementById("defaultOpen2").click();

                // document.getElementById('main-sub-div').style.backgroundColor = "rgba(0, 0, 0, 0.1)";
                sidebarOpen = true;
            } else {
                console.log('hii');
                document.getElementById('sidebar').style.display = "none";
                document.getElementById('main-div').style.opacity = "1";
                document.getElementById('main-div').style.backgroundColor = "#f5f5f5";

                sidebarOpen = false;
            }
        }

        window.onload = function checkingTheme() {
            try {
                let themeCheck = localStorage.getItem('theme');
                if (themeCheck == null || themeCheck == 'light') {
                    document.getElementById('main-div').style.backgroundColor = "#f5f5f5";
                    // document.getElementById('main-sub-div').style.backgroundColor = "white";
                    document.getElementById('body').style.backgroundColor = "#f5f5f5";
                    document.getElementsByClassName('change-theme')[1].classList.add('hide-icon');
                    document.getElementsByClassName('change-theme')[0].classList.remove('hide-icon');
                } else {
                    document.getElementById('main-div').style.backgroundColor = "black";
                    // document.getElementById('main-sub-div').style.backgroundColor = "black";
                    document.getElementById('body').style.backgroundColor = "black";
                    document.getElementsByClassName('change-theme')[0].classList.add('hide-icon');
                    document.getElementsByClassName('change-theme')[1].classList.remove('hide-icon');
                }
            } catch (error) {
                console.log('no themes decided yet');
            }
        }
        function changeTheme() {
            let theme = localStorage.getItem('theme');
            if (theme == null || theme == 'light') {
                localStorage.setItem('theme', 'dark');
                document.getElementById('main-div').style.backgroundColor = "black";
                // document.getElementById('main-sub-div').style.backgroundColor = "black";
                document.getElementById('body').style.backgroundColor = "black";
                document.getElementsByClassName('change-theme')[0].classList.add('hide-icon');
                document.getElementsByClassName('change-theme')[1].classList.remove('hide-icon');
            } else if (theme == 'dark') {
                localStorage.setItem('theme', 'light');
                document.getElementById('main-div').style.backgroundColor = "#f5f5f5";
                // document.getElementById('main-sub-div').style.backgroundColor = "#f5f5f5";
                document.getElementById('body').style.backgroundColor = "#f5f5f5";
                document.getElementsByClassName('change-theme')[1].classList.add('hide-icon');
                document.getElementsByClassName('change-theme')[0].classList.remove('hide-icon');
            }
        }
    </script>

</div>
